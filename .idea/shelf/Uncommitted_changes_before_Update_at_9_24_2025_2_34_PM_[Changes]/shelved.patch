Index: src/main/java/edu/kit/dopler/model/Main.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>/*******************************************************************************\r\n * SPDX-License-Identifier: MPL-2.0\r\n *\r\n * This Source Code Form is subject to the terms of the Mozilla\r\n * Public License, v. 2.0. If a copy of the MPL was not distributed\r\n * with this file, You can obtain one at\r\n * https://mozilla.org/MPL/2.0/.\r\n *\r\n * Contributors: \r\n * \t@author Fabian Eger\r\n * \t@author Kevin Feichtinger\r\n *  @author David Kowal\r\n *\r\n * Copyright 2024 Karlsruhe Institute of Technology (KIT)\r\n * KASTEL - Dependability of Software-intensive Systems\r\n *******************************************************************************/\r\npackage edu.kit.dopler.model;\r\n\r\nimport de.ovgu.featureide.fm.core.JavaLogger;\r\nimport de.ovgu.featureide.fm.core.Logger;\r\nimport de.ovgu.featureide.fm.core.analysis.cnf.LiteralSet;\r\nimport de.ovgu.featureide.fm.core.analysis.cnf.formula.FeatureModelFormula;\r\nimport de.ovgu.featureide.fm.core.analysis.cnf.generator.configuration.AllConfigurationGenerator;\r\nimport de.ovgu.featureide.fm.core.base.IFeatureModel;\r\nimport de.ovgu.featureide.fm.core.base.impl.CoreFactoryWorkspaceLoader;\r\nimport de.ovgu.featureide.fm.core.base.impl.DefaultFeatureModelFactory;\r\nimport de.ovgu.featureide.fm.core.base.impl.FMFactoryManager;\r\nimport de.ovgu.featureide.fm.core.base.impl.MultiFeatureModelFactory;\r\nimport de.ovgu.featureide.fm.core.cli.CLIFunctionManager;\r\nimport de.ovgu.featureide.fm.core.cli.ConfigurationGenerator;\r\nimport de.ovgu.featureide.fm.core.io.FileSystem;\r\nimport de.ovgu.featureide.fm.core.io.JavaFileSystem;\r\nimport de.ovgu.featureide.fm.core.io.uvl.UVLFeatureModelFormat;\r\nimport de.ovgu.featureide.fm.core.job.LongRunningCore;\r\nimport de.ovgu.featureide.fm.core.job.LongRunningWrapper;\r\nimport edu.kit.dopler.exceptions.NotSupportedVariabilityTypeException;\r\nimport edu.kit.dopler.io.DecisionModelReader;\r\n\r\nimport java.io.*;\r\nimport java.nio.file.Files;\r\nimport java.nio.file.Path;\r\nimport java.nio.file.Paths;\r\nimport java.util.List;\r\nimport java.nio.file.Paths;\r\nimport java.util.Scanner;\r\nimport java.util.Set;\r\nimport java.util.stream.Stream;\r\n\r\nimport org.antlr.v4.runtime.CharStream;\r\nimport org.antlr.v4.runtime.CharStreams;\r\nimport org.antlr.v4.runtime.CommonTokenStream;\r\nimport org.antlr.v4.runtime.tree.ParseTree;\r\nimport org.antlr.v4.runtime.tree.ParseTreeWalker;\r\n\r\nimport edu.kit.dopler.exceptions.NotSupportedVariabilityTypeException;\r\nimport edu.kit.dopler.io.DoplerModelWriter;\r\nimport edu.kit.dopler.io.DoplerModelWriter;\r\nimport edu.kit.dopler.io.antlr.DoplerDecisionCreator;\r\nimport edu.kit.dopler.io.antlr.DoplerExpressionParser;\r\nimport edu.kit.dopler.io.antlr.resources.DoplerLexer;\r\nimport edu.kit.dopler.io.antlr.resources.DoplerParser;\r\n\r\npublic class Main {\r\n\r\n\tpublic static void main(final String[] args) throws NotSupportedVariabilityTypeException, IOException {\t\t\r\n\t\t// ANTLR Setup\r\n\t\t// Input file, JSON or CSV\r\n\t\tString fileName = \"dm_dopler.json\";\r\n\t\tCharStream input = CharStreams.fromFileName(fileName);\r\n\t\tDoplerLexer lexer = new DoplerLexer(input);\r\n\t\tCommonTokenStream tokens = new CommonTokenStream(lexer);\r\n\t\tDoplerParser parser = new DoplerParser(tokens);\r\n\t\t\r\n\t\t// Create parse tree\r\n\t\tParseTree tree = parser.document();\r\n\t\tParseTreeWalker walker = new ParseTreeWalker();\r\n\t\t\r\n\t\t// Walk through both listeners, first to create the decisions, second to create the expressions\r\n\t\tDoplerDecisionCreator decisionCreator = new DoplerDecisionCreator(fileName);\r\n\t\twalker.walk(decisionCreator, tree);\r\n\t\tDoplerExpressionParser expressionParser = new DoplerExpressionParser(decisionCreator.getDopler());\r\n\t\twalker.walk(expressionParser, tree);\r\n\t\t\r\n\t\t// Extract Dopler Model\r\n\t\tDopler dopler = expressionParser.getDopler();\r\n\t\t\r\n\t\t// Write Dopler Model in csv and json\r\n\t\tDoplerModelWriter dmw = new DoplerModelWriter();\r\n\t\tdmw.writeCSV(dopler, Paths.get(\"output_dm_dopler.csv\"));\r\n\t\tdmw.writeJson(dopler, Paths.get(\"output_dm_dopler.json\"));\r\n\t\t\r\n\r\n\t\tdopler.toSMTStream().build().forEach(System.out::println);\r\n\t\ttry {\r\n\r\n\t\t\tlong startTime = System.nanoTime();\r\n\t\t\tfinal Stream.Builder<String> builder = dopler.toSMTStream();\r\n\r\n\t\t\tlong endTime = System.nanoTime();\r\n\t\t\tlong duration = (endTime - startTime) / 1000000;\r\n\t\t\tSystem.out.println(\"SMT DOPLER encoding needed: \" + duration+ \"ms\");  //divide by 1000000 to get milliseconds.\r\n\r\n\t\t\t startTime = System.nanoTime();\r\n             getAmountOfConfigs(dopler);\r\n             checkForAnomalies(dopler);\r\n\t\t\t endTime = System.nanoTime();\r\n\t\t\t duration = (endTime - startTime) / 1000000;\r\n\t\t\tSystem.out.println(\"SMT DOPLER needed: \" + duration  + \"ms\");  //divide by 1000000 to get milliseconds.\r\n            \r\n\t\t} catch (final Exception e) {\r\n\t\t\tSystem.out.println(e);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the smt stream of the dopler model and adds the comment (check-sat) and\r\n\t * then calls the satSolver with the stream\r\n\t *\r\n\t * @param builder Stream Builder of the DOPLER MODEL which should be fed into\r\n\t *                the solver\r\n\t * @return True if the encoding is sat or false if the encoding is unsat\r\n\t * @throws Exception\r\n\t */\r\n\tstatic boolean checkSat(final Stream.Builder<String> builder) throws Exception {\r\n\r\n\t\t// needs to be added to retrieve sat/unsat from the solver\r\n\t\tbuilder.add(\"(check-sat)\");\r\n\t\t// builder.add(\"(get-model)\");\r\n\t\tbuilder.add(\"(exit)\");\r\n\t\tfinal Stream<String> stream = builder.build();\r\n\t\tfinal Scanner scanner = satSolver(stream);\r\n\t\tif (scanner == null) {\r\n\t\t\tthrow new Exception();\r\n\t\t}\r\n\t\twhile (scanner.hasNextLine()) {\r\n\t\t\tfinal String line = scanner.nextLine();\r\n\t\t\tif (line.equals(\"sat\")) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (line.equals(\"unsat\")) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthrow new Exception();\r\n\t}\r\n\r\n\tpublic static int getFeatureIDConfigs(Path filePath) throws IOException {\r\n\t\tFileSystem.INSTANCE = new JavaFileSystem();\r\n\t\tLongRunningWrapper.INSTANCE = new LongRunningCore();\r\n\t\tLogger.logger = new JavaLogger();\r\n\r\n\t\tFMFactoryManager.getInstance().addExtension(DefaultFeatureModelFactory.getInstance());\r\n\t\tFMFactoryManager.getInstance().addExtension(MultiFeatureModelFactory.getInstance());\r\n\t\tFMFactoryManager.getInstance().setWorkspaceLoader(new CoreFactoryWorkspaceLoader());\r\n\r\n\t\tCLIFunctionManager.getInstance().addExtension(new ConfigurationGenerator());\r\n\r\n\t\tString content = Files.readString(filePath);\r\n\t\tIFeatureModel featureIdeFm = new MultiFeatureModelFactory().create();\r\n\t\tUVLFeatureModelFormat format = new UVLFeatureModelFormat();\r\n\t\tformat.read(featureIdeFm, content);\r\n\r\n\t\tFeatureModelFormula formula = new FeatureModelFormula(featureIdeFm);\r\n\t\tList<LiteralSet> configs = LongRunningWrapper.runMethod(new AllConfigurationGenerator(formula.getCNF()));\r\n\t\treturn configs.size();\r\n\r\n\t}\r\n\r\n\r\n\tstatic int getAmountOfConfigs(final Dopler dopler) {\r\n\t\tfinal int amount = getAmountOfConfigs(dopler, dopler.toSMTStream());\r\n\t\tSystem.out.println(\"SMT DOPLER variants: \" + amount);\r\n\t\treturn amount;\r\n\t}\r\n\r\n\tstatic int getAmountOfConfigs(final Dopler dopler, final String asserts) {\r\n\t\tfinal Stream.Builder<String> builder = dopler.toSMTStream();\r\n\t\tbuilder.add(asserts);\r\n\t\tfinal int amount = getAmountOfConfigs(dopler, builder);\r\n\t\tSystem.out.println(amount);\r\n\t\treturn amount;\r\n\t}\r\n\r\n\tstatic int getAmountOfConfigsUVLSMT(final String encoding, final String asserts) {\r\n\t\tfinal Stream.Builder<String> builder = Stream.builder();\r\n\t\tbuilder.add(encoding);\r\n\t\t//System.out.println(encoding);\r\n\t\tfinal int amount = getAmountOfConfigsUVLSMT(encoding, builder);\r\n\t\tSystem.out.println(\"UVL variants: \" + amount);\r\n\t\treturn amount;\r\n\t}\r\n\r\n\tstatic void checkForAnomalies(final Dopler dopler) {\r\n\t\tStream.Builder<String> builder = dopler.toSMTStream();\r\n\t\tcheckForDeadDecision(dopler, builder);\r\n\t\tbuilder = dopler.toSMTStream();\r\n\t\tcheckForFalseOptionalDecisions(dopler,builder);\r\n\r\n\t}\r\n\tprivate static void checkForFalseOptionalDecisions(final Dopler doplerModel, Stream.Builder<String> builder){\r\n\t\tbuilder.add(\"(check-sat)\");\r\n\t\tbuilder.add(\"(get-model)\");\r\n\r\n\r\n\t\tfinal Stream<String> stream = builder.build();\r\n\t\tfinal Scanner scanner = satSolver(stream);\r\n\r\n\r\n\t\twhile (true) {\r\n            builder = doplerModel.toSMTStream();\r\n\t\t\tassert scanner != null;\r\n\t\t\tif (!scanner.hasNextLine()) break;\r\n\r\n\t\t\tfinal String line = scanner.nextLine();\r\n\t\t\tif (line.equals(\"unsat\")) {\r\n\t\t\t\tSystem.out.println(\"Void DM\");\r\n\t\t\t\treturn;\r\n\t\t\t} else if(line.contains(\"(define-fun END\")){\r\n\t\t\t\tString[] newLine = line.split(\"\\\\s+\");\r\n\t\t\t\tString nextLine = scanner.nextLine();\r\n\t\t\t\tbuilder.add(\"(assert (= \" + newLine[2]+ \" \" + \"false\" + \"))\");\r\n\t\t\t\tbuilder.add(\"(check-sat)\");\r\n\t\t\t\tbuilder.add(\"(get-model)\");\r\n\t\t\t\tfinal Stream<String> deadDecisionStream = builder.build();\r\n\t\t\t\tfinal Scanner scannerDeadDecision = satSolver(deadDecisionStream);\r\n\t\t\t\twhile (scannerDeadDecision.hasNextLine()) {\r\n\t\t\t\t\tfinal String deadDecisionLine = scannerDeadDecision.nextLine();\r\n\t\t\t\t\t//System.out.println(deadDecisionLine);\r\n\t\t\t\t\tif (deadDecisionLine.equals(\"unsat\")) {\r\n\t\t\t\t\t\tSystem.out.println(\"False Optional Decision Value: \" + newLine[2]);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} else if (deadDecisionLine.equals(\"sat\")) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\tprivate static void checkForDeadDecision(final Dopler doplerModel, Stream.Builder<String> builder){\r\n\t\tbuilder.add(\"(check-sat)\");\r\n\t\tbuilder.add(\"(get-model)\");\r\n\r\n\r\n\t\tfinal Stream<String> stream = builder.build();\r\n\t\tfinal Scanner scanner = satSolver(stream);\r\n\r\n\r\n\t\twhile (true) {\r\n            builder = doplerModel.toSMTStream();\r\n            assert scanner != null;\r\n            if (!scanner.hasNextLine()) break;\r\n\r\n            final String line = scanner.nextLine();\r\n\t\t\tif (line.equals(\"unsat\")) {\r\n\t\t\t\tSystem.out.println(\"Void DM\");\r\n\t\t\t\treturn;\r\n\t\t\t} else if(line.contains(\"(define-fun END\")){\r\n\t\t\t\tString[] newLine = line.split(\"\\\\s+\");\r\n\t\t\t\tString nextLine = scanner.nextLine();\r\n\t\t\t\t//System.out.println(\"Check for Feature: \" +  newLine[2]);\r\n\t\t\t\tbuilder.add(\"(assert (= \" + newLine[2]+ \" \" + \"true\" + \"))\");\r\n\t\t\t\tbuilder.add(\"(check-sat)\");\r\n\t\t\t\tbuilder.add(\"(get-model)\");\r\n\t\t\t\tfinal Stream<String> deadDecisionStream = builder.build();\r\n\r\n\t\t\t\tfinal Scanner scannerDeadDecision = satSolver(deadDecisionStream);\r\n\t\t\t\twhile (scannerDeadDecision.hasNextLine()) {\r\n\t\t\t\t\tfinal String deadDecisionLine = scannerDeadDecision.nextLine();\r\n\t\t\t\t\t//System.out.println(deadDecisionLine);\r\n\t\t\t\t\tif (deadDecisionLine.equals(\"unsat\")) {\r\n\t\t\t\t\t\tSystem.out.println(\"Dead Decision Value: \" + newLine[2]);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} else if (deadDecisionLine.equals(\"sat\")) {\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\r\n\tprivate static int getAmountOfConfigsUVLSMT(final String encoding, Stream.Builder<String> builder) {\r\n\t\tint amount = 0;\r\n\t\tfinal boolean isSAT = true;\r\n\t\tString asserts = \"\";\r\n\r\n\r\n\t\tdo {\r\n\t\t\tbuilder.add(asserts);\r\n\t\t\t//builder.add(\"(minimize (+ (ite DECISION_0_TAKEN_POST 1 0) (ite DECISION_1_TAKEN_POST 1 0) ) )\")\r\n\t\t\tbuilder.add(\"(check-sat)\");\r\n\t\t\tbuilder.add(\"(get-model)\");\r\n\r\n\t\t\tfinal Stream<String> stream = builder.build();\r\n\t\t\tfinal Scanner scanner = satSolver(stream);\r\n\t\t\tbuilder = Stream.builder();\r\n\t\t\tbuilder.add(encoding);\r\n\r\n\t\t\twhile (scanner.hasNextLine()) {\r\n\r\n\t\t\t\tfinal String line = scanner.nextLine();\r\n\t\t\t\tif (line.equals(\"unsat\")) {\r\n\t\t\t\t\treturn amount;\r\n\t\t\t\t}\r\n\t\t\t\tif (line.equals(\"sat\")) {\r\n\r\n\t\t\t\t\tasserts += \"(assert (not (and\";\r\n\t\t\t\t\tamount++;\r\n\t\t\t\t\tSystem.out.println(amount);\r\n\r\n\t\t\t\t} else if (line.equals(\" \")) {\r\n\r\n\t\t\t\t} else if(line.contains(\"(define-fun\")){\r\n\t\t\t\t\tString[] newLine = line.split(\"\\\\s+\");\r\n\t\t\t\t\tString nextLine = scanner.nextLine();\r\n\t\t\t\t\tString[] value = nextLine.split(\"\\\\)\");\r\n\t\t\t\t\t//System.out.println(newLine[2]);\r\n\t\t\t\t\tasserts += \"(= \" + newLine[2]+ \" \" + value[0] + \")\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tasserts += \")))\";\r\n\t\t} while (true);\r\n\r\n\t}\r\n\r\n\r\n\r\n\tprivate static int getAmountOfConfigs(final Dopler dopler, Stream.Builder<String> builder) {\r\n\t\tint amount = 0;\r\n\t\tfinal boolean isSAT = true;\r\n\t\tString asserts = \"\";\r\n\t\t// builder.add(\"(assert (= DECISION_2_TAKEN_POST true))\");\r\n\t\t// builder.add(\"(assert (= DECISION_0_TAKEN_POST true))\");\r\n\t\t// builder.add(\"(assert (= DECISION_1_TAKEN_POST true))\");\r\n\t\tdo {\r\n\t\t\tbuilder.add(asserts);\r\n\t\t\t//builder.add(\"(minimize (+ (ite DECISION_0_TAKEN_POST 1 0) (ite DECISION_1_TAKEN_POST 1 0) ) )\");\r\n\t\t\tbuilder.add(\"(check-sat)\");\r\n\r\n\t\t\tdopler.createGetValueOFEndConstants(builder);\r\n\t\t\tfinal Stream<String> stream = builder.build();\r\n\t\t\tfinal Scanner scanner = satSolver(stream);\r\n\t\t\tbuilder = dopler.toSMTStream();\r\n\r\n\t\t\twhile (scanner.hasNextLine()) {\r\n\t\t\t\tfinal String line = scanner.nextLine();\r\n\t\t\t\tif (line.equals(\"unsat\")) {\r\n\t\t\t\t\treturn amount;\r\n\t\t\t\t}\r\n\t\t\t\tif (line.equals(\"sat\")) {\r\n\r\n\t\t\t\t\tasserts += \"(assert (not (and\";\r\n\t\t\t\t\tamount++;\r\n\r\n\t\t\t\t} else if (line.equals(\" \")) {\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//System.out.println(line);\r\n\t\t\t\t\tfinal String[] result = line.split(\"[\\\\(\\\\)]\");\r\n\r\n\t\t\t\t\tif (result.length == 3) {\r\n\r\n\t\t\t\t\t\tif (!result[2].contains(\"DECISION\")) {\r\n\t\t\t\t\t\t\tasserts += \"(= \" + result[1] + \" (\" + result[2] + \"))\";\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tasserts += \"(= \" + result[2] + \")\";\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if (result.length == 4) {\r\n\t\t\t\t\t\tasserts += \"(= \" + result[1] + \" (\" + result[2] + \"(\" + result[3] + \")))\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tasserts += \"(= \" + result[1] + \")\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tasserts += \")))\";\r\n\r\n\t\t\tSystem.out.println(amount);\r\n\t\t} while (true);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Starts a Process of the local Z3 Solver and feeds him the SMT Encoding Stream\r\n\t *\r\n\t * @param stream SMT Encoding\r\n\t * @return Output of the Solver\r\n\t */\r\n\tstatic Scanner satSolver(final Stream<String> stream) {\r\n\r\n\t\tfinal String[] command = { \"/Documents/z3/z3/build/z3\", \"-in\", \"-smt2\" };\r\n\r\n\t\tfinal ProcessBuilder processBuilder = new ProcessBuilder();\r\n\t\tprocessBuilder.command(\"../z3/build/z3\", \"-in\", \"-smt2\");\r\n\t\tProcess process;\r\n\t\ttry {\r\n\t\t\tprocess = processBuilder.start();\r\n\r\n\t\t\tfinal OutputStream stdin = process.getOutputStream(); // <- Eh?\r\n\t\t\tfinal InputStream stdout = process.getInputStream();\r\n\r\n\t\t\tfinal BufferedReader reader = new BufferedReader(new InputStreamReader(stdout));\r\n\t\t\tfinal BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(stdin));\r\n\r\n\t\t\tstream.forEach(a -> {\r\n\t\t\t\ttry {\r\n\t\t\t\t\twriter.write(a);\r\n\t\t\t\t\twriter.newLine();\r\n\t\t\t\t} catch (final IOException e) {\r\n\t\t\t\t\tthrow new RuntimeException(e);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\twriter.flush();\r\n\t\t\twriter.close();\r\n\t\t\tfinal Scanner scanner = new Scanner(stdout);\r\n\r\n\t\t\treturn scanner;\r\n\t\t} catch (final IOException e1) {\r\n\t\t\t// TODO Auto-generated catch block\r\n\t\t\te1.printStackTrace();\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Starts a Process of the local Z3 Solver and feeds him the SMT Encoding Stream\r\n\t *\r\n\t * @param stream SMT Encoding\r\n\t * @return Output of the Solver\r\n\t */\r\n\tstatic Scanner satSolverWithoutSMT(final Stream<String> stream) {\r\n\r\n\t\tfinal String[] command = { \"/Documents/z3/z3/build/z3\"};\r\n\r\n\t\tfinal ProcessBuilder processBuilder = new ProcessBuilder();\r\n\t\tprocessBuilder.command(\"../../z3/z3/build/z3\");\r\n\t\tProcess process;\r\n\t\ttry {\r\n\t\t\tprocess = processBuilder.start();\r\n\r\n\t\t\tfinal OutputStream stdin = process.getOutputStream(); // <- Eh?\r\n\t\t\tfinal InputStream stdout = process.getInputStream();\r\n\r\n\t\t\tfinal BufferedReader reader = new BufferedReader(new InputStreamReader(stdout));\r\n\t\t\tfinal BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(stdin));\r\n\r\n\t\t\tstream.forEach(a -> {\r\n\t\t\t\ttry {\r\n\t\t\t\t\twriter.write(a);\r\n\t\t\t\t\twriter.newLine();\r\n\t\t\t\t} catch (final IOException e) {\r\n\t\t\t\t\tthrow new RuntimeException(e);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\twriter.flush();\r\n\t\t\twriter.close();\r\n\t\t\tfinal Scanner scanner = new Scanner(stdout);\r\n\r\n\t\t\treturn scanner;\r\n\t\t} catch (final IOException e1) {\r\n\t\t\t// TODO Auto-generated catch block\r\n\t\t\te1.printStackTrace();\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/edu/kit/dopler/model/Main.java b/src/main/java/edu/kit/dopler/model/Main.java
--- a/src/main/java/edu/kit/dopler/model/Main.java	(revision 7535e1db87c5ffd3f8a4ef4ae3892c529126b723)
+++ b/src/main/java/edu/kit/dopler/model/Main.java	(date 1758303279958)
@@ -34,8 +34,6 @@
 import de.ovgu.featureide.fm.core.job.LongRunningCore;
 import de.ovgu.featureide.fm.core.job.LongRunningWrapper;
 import edu.kit.dopler.exceptions.NotSupportedVariabilityTypeException;
-import edu.kit.dopler.io.DecisionModelReader;
-
 import java.io.*;
 import java.nio.file.Files;
 import java.nio.file.Path;
Index: src/test/java/edu/kit/dopler/model/SATEncoderTest.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>/*******************************************************************************\r\n * SPDX-License-Identifier: MPL-2.0\r\n *\r\n * This Source Code Form is subject to the terms of the Mozilla\r\n * Public License, v. 2.0. If a copy of the MPL was not distributed\r\n * with this file, You can obtain one at\r\n * https://mozilla.org/MPL/2.0/.\r\n *\r\n * Contributors: \r\n * \t@author Fabian Eger\r\n * \t@author Kevin Feichtinger\r\n *\r\n * Copyright 2024 Karlsruhe Institute of Technology (KIT)\r\n * KASTEL - Dependability of Software-intensive Systems\r\n *******************************************************************************/\r\npackage edu.kit.dopler.model;\r\n\r\nimport de.ovgu.featureide.fm.core.JavaLogger;\r\nimport de.ovgu.featureide.fm.core.Logger;\r\nimport de.ovgu.featureide.fm.core.analysis.cnf.LiteralSet;\r\nimport de.ovgu.featureide.fm.core.analysis.cnf.analysis.ContradictionAnalysis;\r\nimport de.ovgu.featureide.fm.core.analysis.cnf.formula.FeatureModelFormula;\r\nimport de.ovgu.featureide.fm.core.analysis.cnf.generator.configuration.AllConfigurationGenerator;\r\nimport de.ovgu.featureide.fm.core.analysis.cnf.generator.configuration.twise.TWiseConfigurationGenerator;\r\nimport de.ovgu.featureide.fm.core.base.IFeatureModel;\r\nimport de.ovgu.featureide.fm.core.base.impl.*;\r\nimport de.ovgu.featureide.fm.core.cli.CLIFunctionManager;\r\nimport de.ovgu.featureide.fm.core.cli.ConfigurationGenerator;\r\nimport de.ovgu.featureide.fm.core.io.FileSystem;\r\nimport de.ovgu.featureide.fm.core.io.JavaFileSystem;\r\nimport de.ovgu.featureide.fm.core.io.ProblemList;\r\nimport de.ovgu.featureide.fm.core.io.uvl.UVLFeatureModelFormat;\r\nimport de.ovgu.featureide.fm.core.job.LongRunningCore;\r\nimport de.ovgu.featureide.fm.core.job.LongRunningWrapper;\r\nimport edu.kit.dopler.exceptions.NotSupportedVariabilityTypeException;\r\nimport edu.kit.dopler.io.DecisionModelReader;\r\nimport junit.framework.TestCase;\r\n\r\n\r\n\r\nimport java.io.IOException;\r\nimport java.nio.file.Files;\r\nimport java.nio.file.Path;\r\nimport java.nio.file.Paths;\r\nimport java.util.ArrayList;\r\nimport java.util.HashSet;\r\nimport java.util.List;\r\nimport java.util.Set;\r\nimport java.util.stream.Stream;\r\n\r\nimport static edu.kit.dopler.model.Main.checkSat;\r\nimport static edu.kit.dopler.model.Main.getAmountOfConfigs;\r\n\r\npublic class SATEncoderTest extends TestCase {\r\n\r\n    public int getFeatureIDConfigs(Path filePath) throws IOException {\r\n        FileSystem.INSTANCE = new JavaFileSystem();\r\n        LongRunningWrapper.INSTANCE = new LongRunningCore();\r\n        Logger.logger = new JavaLogger();\r\n\r\n        FMFactoryManager.getInstance().addExtension(DefaultFeatureModelFactory.getInstance());\r\n        FMFactoryManager.getInstance().addExtension(MultiFeatureModelFactory.getInstance());\r\n        FMFactoryManager.getInstance().setWorkspaceLoader(new CoreFactoryWorkspaceLoader());\r\n\r\n        CLIFunctionManager.getInstance().addExtension(new ConfigurationGenerator());\r\n\r\n        String content = Files.readString(filePath);\r\n        IFeatureModel featureIdeFm = new MultiFeatureModelFactory().create();\r\n        UVLFeatureModelFormat format = new UVLFeatureModelFormat();\r\n        format.read(featureIdeFm, content);\r\n\r\n        FeatureModelFormula formula = new FeatureModelFormula(featureIdeFm);\r\n        List<LiteralSet> configs = LongRunningWrapper.runMethod(new AllConfigurationGenerator(formula.getCNF()));\r\n        return configs.size();\r\n\r\n    }\r\n\r\n\r\n    public void testVariantsWaterfilter() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/product_waterfilter.csv\"));\r\n        assertEquals(10,getAmountOfConfigs(dopler,\"\"));\r\n    }\r\n\r\n    public void testVariantsHICSSDM() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelCSVs/HICSSDM.csv\"));\r\n        assertEquals(4185,getAmountOfConfigs(dopler,\"(assert (= END_DECISION_0_Particular_Packages true)) (assert (= END_DECISION_3_Document_Management true)) (assert (= END_DECISION_3_Customer_Management true)) (assert (= END_DECISION_3_Claims_Management true))\"));\r\n\r\n    }\r\n\r\n    public void testVariantsHICSSDMOnlySolution() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/HICSSDM.csv\"));\r\n        assertEquals(2,getAmountOfConfigs(dopler,\"(assert (= END_DECISION_0_Solution true))\"));\r\n\r\n    }\r\n\r\n    public void testVariantsVaMoS() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/dm_VaMoS.csv\"));\r\n        assertEquals(30,getAmountOfConfigs(dopler,\"(assert (= END_DECISION_2 true))\"));\r\n\r\n    }\r\n\r\n    public void testVariantsDoplerTools() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/dm_DOPLERTools2.csv\"));\r\n        String asserts = \" (assert (= END_DECISION_12 true)) (assert (= END_DECISION_13 true)) (assert (= END_DECISION_16_Table-based true)) (assert (= END_DECISION_21_After-first-selection true)) (assert (= END_DECISION_17 true)) (assert (= END_DECISION_20 true)) (assert (= END_DECISION_5 true)) (assert (= END_DECISION_8 true)) (assert (= END_DECISION_10 true)) (assert (= END_DECISION_3 true))\";\r\n        assertEquals(2048,getAmountOfConfigs(dopler,asserts));\r\n\r\n    }\r\n\r\n    public void testVariantsrockerswitch() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/product_rockerswitch.csv\"));\r\n        String asserts = \" (assert (= END_DECISION_0 true))(assert (= END_DECISION_8 true)) (assert (= END_DECISION_13 true)) (assert (= END_DECISION_15 true)) (assert (= END_DECISION_21 true)) (assert (= END_DECISION_22 true))\";\r\n        assertEquals(1536,getAmountOfConfigs(dopler,asserts));\r\n\r\n    }\r\n\r\n    public void testVariantseShop() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/dm_eShop_DM.csv\"));\r\n\r\n        assertEquals(76,getAmountOfConfigs(dopler,\"\"));\r\n\r\n    }\r\n\r\n    public void testVariantsASEJ1() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/dm_ASEJ1.csv\"));\r\n        Path filePath = Paths.get(System.getProperty(\"user.dir\") + \"/modelEval/ASEJ1.uvl\");\r\n\r\n        assertEquals(getFeatureIDConfigs(filePath),getAmountOfConfigs(dopler,\"\"));\r\n\r\n    }\r\n\r\n    public void testVariantsDissModel() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/dm_DissModel.csv\"));\r\n        Path filePath = Paths.get(System.getProperty(\"user.dir\") + \"/modelEval/dm_DissModel.uvl\");\r\n        assertEquals(getFeatureIDConfigs(filePath),getAmountOfConfigs(dopler,\"\"));\r\n\r\n    }\r\n\r\n    public void testVariantsPizzas() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/Pizzas.csv\"));\r\n        Path filePath = Paths.get(System.getProperty(\"user.dir\") + \"/modelEval/pizza.uvl\");\r\n        assertEquals(getFeatureIDConfigs(filePath),getAmountOfConfigs(dopler,\"\"));\r\n\r\n    }\r\n\r\n    public void testPerformanceFeatureIde() throws IOException {\r\n        Path filePath = Paths.get(System.getProperty(\"user.dir\") + \"/modelEval/dm_DissModel.uvl\");\r\n        System.out.println(getFeatureIDConfigs(filePath));\r\n    }\r\n\r\n    public void testPerformanceSMT() throws IOException, NotSupportedVariabilityTypeException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/dm_DissModel.csv\"));\r\n        getAmountOfConfigs(dopler,\"\");\r\n    }\r\n\r\n\r\n    public void testVariantsPizzas2() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/Pizzas2.csv\"));\r\n\r\n        assertEquals(21,getAmountOfConfigs(dopler,\"\"));\r\n\r\n    }\r\n\r\n    public void testVariantsShiftfork() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/product_shiftfork.csv\"));\r\n\r\n        assertEquals(4,getAmountOfConfigs(dopler,\"\"));\r\n\r\n    }\r\n\r\n    public void testVariantsTruck() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/product_truck.csv\"));\r\n\r\n        assertEquals(4,getAmountOfConfigs(dopler,\"\"));\r\n\r\n    }\r\n\r\n    public void testVariantsChesspiece() throws NotSupportedVariabilityTypeException, IOException {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelEval/product_chesspiece.csv\"));\r\n\r\n        assertEquals(6,getAmountOfConfigs(dopler,\"\"));\r\n\r\n    }\r\n    public void testGetModelsFromCsv() throws Exception {\r\n\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelCSVs/dm_DOPLERTools.csv\"));\r\n        dopler.toSMTStream().build().forEach(System.out::println);\r\n        assertTrue(checkSat(dopler.toSMTStream()));\r\n        /**\r\n         Stream.Builder<String> builder = dopler.toSMTStream();\r\n        builder.add(\"(assert (= END_DECISION_2_Sicilian true))\");\r\n        assertTrue(checkSat(builder));\r\n         **/\r\n    }\r\n\r\n    public void testEShopModelwithUnsatAsserts() throws Exception {\r\n\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelCSVs/dm_eShop_DM.csv\"));\r\n        Stream.Builder<String> builder = dopler.toSMTStream();\r\n        builder.add(\"(assert (= END_DECISION_5_Payments true))\");\r\n        builder.add(\"(assert (= END_DECISION_4 false))\");\r\n        assertFalse(checkSat(builder));\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Asserts that a decision is not Taken but another isTaken with the visibility condition (if the first isTaken) -> so it should be unsat\r\n     * @throws Exception\r\n     */\r\n    public void testDissModelwithUnsatAssert() throws Exception {\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelCSVs/dm_DissModel.csv\"));\r\n        Stream.Builder<String> builder = dopler.toSMTStream();\r\n        builder.add(\"(assert (= DECISION_0_TAKEN_POST false))\");\r\n        builder.add(\"(assert (= DECISION_2_TAKEN_POST true))\");\r\n        assertFalse(checkSat(builder));\r\n    }\r\n\r\n    public void testEShopModelwithUnsatAssertsForInvalidCardinality() throws Exception {\r\n\r\n        DecisionModelReader decisionModelReader = new DecisionModelReader();\r\n        Dopler dopler = decisionModelReader.read(Path.of( System.getProperty(\"user.dir\") +\"/modelCSVs/dm_eShop_DM.csv\"));\r\n        Stream.Builder<String> builder = dopler.toSMTStream();\r\n        builder.add(\"(assert (= END_DECISION_5_Payments false))\");\r\n        builder.add(\"(assert (= END_DECISION_5_Security false))\");\r\n        builder.add(\"(assert (= END_DECISION_5_Orders false))\");\r\n        builder.add(\"(assert (= END_DECISION_5_Wishlist false))\");\r\n        assertFalse(checkSat(builder));\r\n\r\n    }\r\n\r\n\r\n\r\n    public void testDoplerModelVaMoS() throws Exception {\r\n\r\n        Dopler dopler = new Dopler(new HashSet<>(),new HashSet<>(),new HashSet<>(),\"\");\r\n        BooleanDecision decision1 = new BooleanDecision(\"test\", \"Support GSM 1900 protocol?\",\"\",new BooleanLiteralExpression(true), new HashSet<>());\r\n        dopler.addDecision(decision1);\r\n\r\n\r\n        Enumeration enumerationDecision2 = new Enumeration(new HashSet<>(){{\r\n            add(new EnumerationLiteral(\"WAV\"));\r\n            add(new EnumerationLiteral(\"MP3\"));\r\n        }});\r\n        EnumerationDecision decision2 = new EnumerationDecision(\"test\", \"Which audio formats shall be supported?\",\"\", new BooleanLiteralExpression(true), new HashSet<>(),enumerationDecision2,1,2);\r\n        dopler.addDecision(decision2);\r\n\r\n        BooleanDecision decision3 = new BooleanDecision(\"test\", \"Support for taking photos?\",\"\",new BooleanLiteralExpression(true), new HashSet<>());\r\n        dopler.addDecision(decision3);\r\n\r\n\r\n        Enumeration enumerationDecision4 = new Enumeration(new HashSet<>(){{\r\n            add(new EnumerationLiteral(\"2.1MP\"));\r\n            add(new EnumerationLiteral(\"5MP\"));\r\n            add(new EnumerationLiteral(\"3.1MP\"));\r\n        }});\r\n\r\n        IExpression expression = new Equals(new DecisionValueCallExpression(decision3),new BooleanLiteralExpression(true));\r\n        EnumerationDecision decision4 = new EnumerationDecision(\"test\", \"Required camera resolution?\",\"\", expression, new HashSet<>(),enumerationDecision4,1,1);\r\n        dopler.addDecision(decision4);\r\n\r\n\r\n\r\n\r\n\r\n        BooleanDecision decision5 = new BooleanDecision(\"test\", \"Support for recording MP3 audio?\",\"\",new BooleanLiteralExpression(true), new HashSet<>());\r\n        IExpression expression2 = new Equals(new DecisionValueCallExpression(decision5),new BooleanLiteralExpression(true));\r\n\r\n        Rule rule = new Rule(expression2,new HashSet<>(){{\r\n            add(new EnumEnforce(decision2, new StringValue(\"MP3\")));\r\n        }});\r\n        decision5.addRule(rule);\r\n        dopler.addDecision(decision5);\r\n\r\n        dopler.toSMTStream().build().forEach(System.out::println);\r\n        assertTrue(checkSat(dopler.toSMTStream()));\r\n\r\n    }\r\n\r\n    public void testDoplerModelEShop() throws Exception {\r\n\r\n        Dopler dopler = new Dopler(new HashSet<>(),new HashSet<>(),new HashSet<>(),\"\");\r\n        BooleanDecision decision1 = new BooleanDecision(\"test\", \"Do you want to create an Onlineshop?\",\"\",new BooleanLiteralExpression(true), new HashSet<>());\r\n        dopler.addDecision(decision1);\r\n\r\n\r\n        Enumeration enumerationDecision2 = new Enumeration(new HashSet<>(){{\r\n            add(new EnumerationLiteral(\"DebitCard\"));\r\n            add(new EnumerationLiteral(\"CreditCard\"));\r\n        }});\r\n        EnumerationDecision decision2 = new EnumerationDecision(\"test\", \"Which payment methods should be supported??\",\"\", new BooleanLiteralExpression(true), new HashSet<>(),enumerationDecision2,1,1);\r\n        dopler.addDecision(decision2);\r\n\r\n        BooleanDecision decision3 = new BooleanDecision(\"test\", \"Should a search function be suppoted?\",\"\",new BooleanLiteralExpression(true), new HashSet<>());\r\n        IExpression expressionDecision3 = new Equals(new DecisionValueCallExpression(decision3),new BooleanLiteralExpression(false));\r\n\r\n        Enumeration enumerationDecision6 = new Enumeration(new HashSet<>(){{\r\n            add(new EnumerationLiteral(\"Orders\"));\r\n            add(new EnumerationLiteral(\"Security\"));\r\n            add(new EnumerationLiteral(\"Payments\"));\r\n            add(new EnumerationLiteral(\"Wishlist\"));\r\n        }});\r\n\r\n\r\n\r\n\r\n\r\n        BooleanDecision decision4 = new BooleanDecision(\"test\", \"Split products into categories?\",\"\",new BooleanLiteralExpression(true), new HashSet<>());\r\n\r\n\r\n        BooleanDecision decision5 = new BooleanDecision(\"test\", \"Should products be sortable?\",\"\",new BooleanLiteralExpression(true), new HashSet<>());\r\n\r\n        dopler.addDecision(decision4);\r\n        dopler.addDecision(decision5);\r\n\r\n        EnumerationDecision decision6 = new EnumerationDecision(\"test\", \"Which user management enhancements should be supported?\",\"\", new BooleanLiteralExpression(true), new HashSet<>(),enumerationDecision6,1,4);\r\n        dopler.addDecision(decision6);\r\n\r\n        Rule rule1Decision3 = new Rule(expressionDecision3,new HashSet<>(){{\r\n            add(new EnumEnforce(decision5, BooleanValue.getTrue()));\r\n        }});\r\n\r\n        IExpression expression2Decision3 = new Equals(new DecisionValueCallExpression(decision3),new BooleanLiteralExpression(true));\r\n\r\n        Rule rule2Decision3 = new Rule(expression2Decision3,new HashSet<>(){{\r\n            add(new EnumEnforce(decision6, new StringValue(\"Security\")));\r\n        }});\r\n        decision3.addRule(rule1Decision3);\r\n        decision3.addRule(rule2Decision3);\r\n        dopler.addDecision(decision3);\r\n\r\n        Rule rule1Decision5 = new Rule(\r\n                new Equals(new DecisionValueCallExpression(decision5),new BooleanLiteralExpression(false)),\r\n                new HashSet<>(){{\r\n                    add(new BooleanEnforce(decision3, BooleanValue.getTrue()));\r\n                }});\r\n\r\n        decision5.addRule(rule1Decision5);\r\n\r\n        decision6.addRule(\r\n                new Rule(\r\n                        new NOT(new Equals(new DecisionValueCallExpression(decision6),new EnumeratorLiteralExpression(new EnumerationLiteral(\"Security\")))),\r\n                        new HashSet<>(){{\r\n                            add(new Allows(decision6, new StringValue(\"Payments\")));\r\n                        }}\r\n                )\r\n        );\r\n\r\n        decision6.addRule(\r\n                new Rule(\r\n                        new Equals(new DecisionValueCallExpression(decision6),new EnumeratorLiteralExpression(new EnumerationLiteral(\"Security\"))),\r\n                        new HashSet<>(){{\r\n                            add(new DisAllows(decision6, new StringValue(\"Payments\")));\r\n                        }}\r\n                )\r\n        );\r\n\r\n        decision6.addRule(\r\n                new Rule(\r\n                        new NOT(new Equals(new DecisionValueCallExpression(decision6),new EnumeratorLiteralExpression(new EnumerationLiteral(\"Payments\")))),\r\n                        new HashSet<>(){{\r\n                            add(new Allows(decision6, new StringValue(\"Security\")));\r\n                        }}\r\n                )\r\n        );\r\n\r\n        decision6.addRule(\r\n                new Rule(\r\n                        new Equals(new DecisionValueCallExpression(decision6),new EnumeratorLiteralExpression(new EnumerationLiteral(\"Payments\"))),\r\n                        new HashSet<>(){{\r\n                            add(new DisAllows(decision6, new StringValue(\"Security\")));\r\n                        }}\r\n                )\r\n        );\r\n\r\n\r\n\r\n\r\n        dopler.toSMTStream().build().forEach(System.out::println);\r\n        assertTrue(checkSat(dopler.toSMTStream()));\r\n\r\n    }\r\n\r\n\r\n    public void testDoplerModelPizzas() throws Exception {\r\n        Dopler dopler = new Dopler(new HashSet<>(),new HashSet<>(),new HashSet<>(),\"\");\r\n\r\n\r\n\r\n        Enumeration enumerationDecision2 = new Enumeration(new HashSet<>(){{\r\n            add(new EnumerationLiteral(\"Salami\"));\r\n            add(new EnumerationLiteral(\"Ham\"));\r\n            add(new EnumerationLiteral(\"Mozzarella\"));\r\n        }});\r\n        EnumerationDecision decision2 = new EnumerationDecision(\"test\", \"Which Topping do you want on your pizza?\",\"\", new BooleanLiteralExpression(true), new HashSet<>(),enumerationDecision2,1,3);\r\n        dopler.addDecision(decision2);\r\n\r\n\r\n        Enumeration enumerationDecision3 = new Enumeration(new HashSet<>(){{\r\n            add(new EnumerationLiteral(\"Normal\"));\r\n            add(new EnumerationLiteral(\"Big\"));\r\n        }});\r\n        EnumerationDecision decision3 = new EnumerationDecision(\"test\", \"Which Size should the pizza have?\",\"\", new BooleanLiteralExpression(true), new HashSet<>(),enumerationDecision3,1,1);\r\n        dopler.addDecision(decision3);\r\n\r\n\r\n        Enumeration enumerationDecision4 = new Enumeration(new HashSet<>(){{\r\n            add(new EnumerationLiteral(\"Neapolitan\"));\r\n            add(new EnumerationLiteral(\"Sicilian\"));\r\n        }});\r\n        EnumerationDecision decision4 = new EnumerationDecision(\"test\", \"Which Dough do you prefer??\",\"\", new BooleanLiteralExpression(true), new HashSet<>(),enumerationDecision4,1,1);\r\n        dopler.addDecision(decision4);\r\n\r\n\r\n        BooleanDecision decision1 = new BooleanDecision(\"test\", \"Should the pizza have a cheesy crust?\",\"\",new BooleanLiteralExpression(true), new HashSet<>());\r\n        dopler.addDecision(decision1);\r\n\r\n        IExpression expressionDecision1 = new Equals(new DecisionValueCallExpression(decision1),new BooleanLiteralExpression(true));\r\n\r\n        Rule ruleDecision1 = new Rule(expressionDecision1,new HashSet<>(){{\r\n            add(new EnumEnforce(decision3, new StringValue(\"Big\")));\r\n        }});\r\n        decision1.addRule(ruleDecision1);\r\n\r\n        dopler.toSMTStream().build().forEach(System.out::println);\r\n        assertTrue(checkSat(dopler.toSMTStream()));\r\n\r\n    }\r\n\r\n    public void testreviewerTest() throws Exception {\r\n\r\n\r\n        Dopler dopler = new Dopler(new HashSet<>(),new HashSet<>(),new HashSet<>(),\"\");\r\n        BooleanDecision decision1 = new BooleanDecision(\"test\", \"Do you want to create an Onlineshop?\",\"\",new BooleanLiteralExpression(true), new HashSet<>());\r\n\r\n\r\n\r\n        BooleanDecision decision3 = new BooleanDecision(\"test\", \"Should a search function be suppoted?\",\"\",new BooleanLiteralExpression(true), new HashSet<>());\r\n        decision3.setVisibilityCondition(new IsTaken(decision1));\r\n        decision1.setVisibilityCondition(new IsTaken(decision3));\r\n\r\n\r\n\r\n        dopler.addDecision(decision1);\r\n        dopler.addDecision(decision3);\r\n        dopler.toSMTStream().build().forEach(System.out::println);\r\n        getAmountOfConfigs(dopler,\"\");\r\n\r\n        assertTrue(checkSat(dopler.toSMTStream()));\r\n    }\r\n\r\n\r\n    public void testDoplerModelPizzas2() throws Exception {\r\n        Dopler dopler = new Dopler(new HashSet<>(),new HashSet<>(),new HashSet<>(),\"\");\r\n\r\n\r\n\r\n        Enumeration enumerationDecision2 = new Enumeration(new HashSet<>(){{\r\n            add(new EnumerationLiteral(\"Salami\"));\r\n            add(new EnumerationLiteral(\"Ham\"));\r\n            add(new EnumerationLiteral(\"Mozzarella\"));\r\n        }});\r\n        EnumerationDecision decision2 = new EnumerationDecision(\"test\", \"Which Topping do you want on your pizza?\",\"\", new BooleanLiteralExpression(true), new HashSet<>(),enumerationDecision2,1,3);\r\n        dopler.addDecision(decision2);\r\n\r\n\r\n        Enumeration enumerationDecision3 = new Enumeration(new HashSet<>(){{\r\n            add(new EnumerationLiteral(\"Normal\"));\r\n            add(new EnumerationLiteral(\"Big\"));\r\n        }});\r\n        EnumerationDecision decision3 = new EnumerationDecision(\"test\", \"Which Size should the pizza have?\",\"\", new BooleanLiteralExpression(true), new HashSet<>(),enumerationDecision3,1,1);\r\n        dopler.addDecision(decision3);\r\n\r\n\r\n        Enumeration enumerationDecision4 = new Enumeration(new HashSet<>(){{\r\n            add(new EnumerationLiteral(\"Neapolitan\"));\r\n            add(new EnumerationLiteral(\"Sicilian\"));\r\n        }});\r\n        EnumerationDecision decision4 = new EnumerationDecision(\"test\", \"Which Dough do you prefer??\",\"\", new BooleanLiteralExpression(true), new HashSet<>(),enumerationDecision4,1,1);\r\n        dopler.addDecision(decision4);\r\n\r\n\r\n        BooleanDecision decision1 = new BooleanDecision(\"test\", \"Should the pizza have a cheesy crust?\",\"\",new BooleanLiteralExpression(true), new HashSet<>());\r\n        dopler.addDecision(decision1);\r\n\r\n        IExpression expressionDecision3 = new Equals(new DecisionValueCallExpression(decision3),new EnumeratorLiteralExpression(new EnumerationLiteral(\"Big\")));\r\n\r\n        Rule ruleDecision3 = new Rule(expressionDecision3,new HashSet<>(){{\r\n            add(new EnumEnforce(decision4, new StringValue(\"Neapolitan\")));\r\n        }});\r\n        decision3.addRule(ruleDecision3);\r\n\r\n        IExpression expressionDecision4 = new Equals(new DecisionValueCallExpression(decision4),new EnumeratorLiteralExpression(new EnumerationLiteral(\"Sicilian\")));\r\n\r\n        Rule ruleDecision4 = new Rule(expressionDecision4,new HashSet<>(){{\r\n            add(new BooleanEnforce(decision1, BooleanValue.getTrue()));\r\n        }});\r\n        decision4.addRule(ruleDecision4);\r\n\r\n\r\n\r\n        IExpression expressionDecision1 = new Equals(new DecisionValueCallExpression(decision1),new BooleanLiteralExpression(true));\r\n\r\n        Rule ruleDecision1 = new Rule(expressionDecision1,new HashSet<>(){{\r\n            add(new EnumEnforce(decision3, new StringValue(\"Big\")));\r\n        }});\r\n        decision1.addRule(ruleDecision1);\r\n\r\n        dopler.toSMTStream().build().forEach(System.out::println);\r\n        assertTrue(checkSat(dopler.toSMTStream()));\r\n\r\n    }\r\n\r\n    public void testDoplerModelPizzas2withUnsatAssert() throws Exception {\r\n        Dopler dopler = new Dopler(new HashSet<>(),new HashSet<>(),new HashSet<>(),\"\");\r\n\r\n\r\n\r\n        Enumeration enumerationDecision2 = new Enumeration(new HashSet<>(){{\r\n            add(new EnumerationLiteral(\"Salami\"));\r\n            add(new EnumerationLiteral(\"Ham\"));\r\n            add(new EnumerationLiteral(\"Mozzarella\"));\r\n        }});\r\n        EnumerationDecision decision2 = new EnumerationDecision(\"test\", \"Which Topping do you want on your pizza?\",\"\", new BooleanLiteralExpression(true), new HashSet<>(),enumerationDecision2,1,3);\r\n        dopler.addDecision(decision2);\r\n\r\n\r\n        Enumeration enumerationDecision3 = new Enumeration(new HashSet<>(){{\r\n            add(new EnumerationLiteral(\"Normal\"));\r\n            add(new EnumerationLiteral(\"Big\"));\r\n        }});\r\n        EnumerationDecision decision3 = new EnumerationDecision(\"test\", \"Which Size should the pizza have?\",\"\", new BooleanLiteralExpression(true), new HashSet<>(),enumerationDecision3,1,1);\r\n        dopler.addDecision(decision3);\r\n\r\n\r\n        Enumeration enumerationDecision4 = new Enumeration(new HashSet<>(){{\r\n            add(new EnumerationLiteral(\"Neapolitan\"));\r\n            add(new EnumerationLiteral(\"Sicilian\"));\r\n        }});\r\n        EnumerationDecision decision4 = new EnumerationDecision(\"test\", \"Which Dough do you prefer??\",\"\", new BooleanLiteralExpression(true), new HashSet<>(),enumerationDecision4,1,1);\r\n        dopler.addDecision(decision4);\r\n\r\n\r\n        BooleanDecision decision1 = new BooleanDecision(\"test\", \"Should the pizza have a cheesy crust?\",\"\",new BooleanLiteralExpression(true), new HashSet<>());\r\n        dopler.addDecision(decision1);\r\n\r\n        IExpression expressionDecision3 = new Equals(new DecisionValueCallExpression(decision3),new EnumeratorLiteralExpression(new EnumerationLiteral(\"Big\")));\r\n\r\n        Rule ruleDecision3 = new Rule(expressionDecision3,new HashSet<>(){{\r\n            add(new EnumEnforce(decision4, new StringValue(\"Neapolitan\")));\r\n        }});\r\n        decision3.addRule(ruleDecision3);\r\n\r\n        IExpression expressionDecision4 = new Equals(new DecisionValueCallExpression(decision4),new EnumeratorLiteralExpression(new EnumerationLiteral(\"Sicilian\")));\r\n\r\n        Rule ruleDecision4 = new Rule(expressionDecision4,new HashSet<>(){{\r\n            add(new BooleanEnforce(decision1, BooleanValue.getTrue()));\r\n        }});\r\n        decision4.addRule(ruleDecision4);\r\n\r\n\r\n\r\n        IExpression expressionDecision1 = new Equals(new DecisionValueCallExpression(decision1),new BooleanLiteralExpression(true));\r\n\r\n        Rule ruleDecision1 = new Rule(expressionDecision1,new HashSet<>(){{\r\n            add(new EnumEnforce(decision3, new StringValue(\"Big\")));\r\n        }});\r\n        decision1.addRule(ruleDecision1);\r\n\r\n        dopler.toSMTStream().build().forEach(System.out::println);\r\n        Stream.Builder<String> builder = dopler.toSMTStream();\r\n        builder.add(\"(assert (= END_DECISION_2_Sicilian true))\");\r\n        assertFalse(checkSat(builder));\r\n\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/test/java/edu/kit/dopler/model/SATEncoderTest.java b/src/test/java/edu/kit/dopler/model/SATEncoderTest.java
--- a/src/test/java/edu/kit/dopler/model/SATEncoderTest.java	(revision 7535e1db87c5ffd3f8a4ef4ae3892c529126b723)
+++ b/src/test/java/edu/kit/dopler/model/SATEncoderTest.java	(date 1758303294842)
@@ -33,7 +33,6 @@
 import de.ovgu.featureide.fm.core.job.LongRunningCore;
 import de.ovgu.featureide.fm.core.job.LongRunningWrapper;
 import edu.kit.dopler.exceptions.NotSupportedVariabilityTypeException;
-import edu.kit.dopler.io.DecisionModelReader;
 import junit.framework.TestCase;
 
 
